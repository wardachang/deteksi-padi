<!DOCTYPE html>
<html lang="id" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Deteksi Penyakit Padi</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

  <!-- Inter Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    body { font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
  </style>
</head>

<body class="h-full bg-[#F3F6F3] text-slate-900">
  <div class="min-h-screen flex">

    <!-- SIDEBAR -->
    <aside class="hidden md:flex w-72 flex-col bg-white border-r border-slate-200">
      <!-- brand -->
      <div class="px-6 py-6 flex items-center gap-3">
        <div class="h-10 w-10 rounded-xl bg-emerald-100 flex items-center justify-center">
          <i class="fa-solid fa-leaf text-emerald-600"></i>
        </div>
        <div class="font-extrabold tracking-tight">Rice Health System</div>
      </div>

      <!-- nav -->
      <nav class="px-4 space-y-2">
        <a href="#" class="flex items-center gap-3 px-4 py-3 rounded-xl text-slate-600 hover:bg-slate-50">
          <i class="fa-solid fa-house text-emerald-500 w-5"></i>
          <span class="font-semibold text-sm">Beranda</span>
        </a>

        <a href="#" class="flex items-center gap-3 px-4 py-3 rounded-xl text-slate-600 hover:bg-slate-50">
          <i class="fa-solid fa-calendar-days text-emerald-500 w-5"></i>
          <span class="font-semibold text-sm">Jadwal Tanam</span>
        </a>

        <a href="#" class="flex items-center gap-3 px-4 py-3 rounded-xl bg-emerald-500 text-white shadow-sm">
          <i class="fa-solid fa-magnifying-glass text-white w-5"></i>
          <span class="font-semibold text-sm">Deteksi Penyakit</span>
        </a>

        <a href="#" class="flex items-center gap-3 px-4 py-3 rounded-xl text-slate-600 hover:bg-slate-50">
          <i class="fa-solid fa-clock-rotate-left text-emerald-500 w-5"></i>
          <span class="font-semibold text-sm">Riwayat</span>
        </a>
      </nav>

      <!-- user -->
      <div class="mt-auto p-4">
        <div class="rounded-xl border border-slate-200 bg-slate-50 p-3 flex items-center gap-3">
          <div class="h-10 w-10 rounded-full bg-emerald-200 flex items-center justify-center">
            <i class="fa-solid fa-user text-emerald-700"></i>
          </div>
          <div class="leading-tight">
            <div class="text-sm font-bold">Budi Santoso</div>
            <div class="text-xs text-slate-500"> </div>
          </div>
        </div>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1">
      <div class="max-w-6xl mx-auto px-4 md:px-8 py-8">

        <!-- header -->
        <div class="mb-6">
          <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">Deteksi Penyakit Padi</h1>
          <p class="mt-2 text-slate-600 max-w-3xl">
            Identifikasi penyakit tanaman padi Anda secara instan dengan sistem deteksi berbasis kecerdasan buatan.
          </p>
        </div>

        <!-- grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <!-- UPLOAD CARD -->
          <section class="lg:col-span-2">
            <div class="bg-white border border-slate-200 rounded-2xl shadow-sm overflow-hidden">
              <div class="px-6 py-4 border-b border-slate-100 flex items-center gap-3">
                <span class="inline-flex h-8 w-8 items-center justify-center rounded-lg bg-emerald-100">
                  <i class="fa-solid fa-cloud-arrow-up text-emerald-600"></i>
                </span>
                <h2 class="font-extrabold">Unggah Gambar Daun Padi</h2>
              </div>

              <div class="p-6">
                <form method="POST" enctype="multipart/form-data" class="space-y-6">
                  <!-- Dropzone -->
                  <label
                    id="dropzone"
                    class="block rounded-2xl border border-dashed border-slate-200 bg-white p-8 md:p-12 text-center cursor-pointer
                           hover:bg-slate-50 transition"
                  >
                    <input
                      id="fileInput"
                      class="sr-only"
                      type="file"
                      name="file"
                      accept="image/*"
                      required
                      onchange="handleFileSelect(event)"
                    />

                    <div class="mx-auto h-14 w-14 rounded-full bg-emerald-100 flex items-center justify-center">
                      <i class="fa-regular fa-image text-emerald-600 text-xl"></i>
                    </div>

                    <div class="mt-6 text-lg font-extrabold text-slate-800">Tarik dan lepas gambar di sini</div>
                    <p class="mt-2 text-sm text-slate-500 max-w-md mx-auto">
                      Format yang didukung: JPG, PNG. Pastikan daun terlihat jelas, terpusat, dan mengisi sebagian besar frame.
                    </p>

                    <div class="mt-6 flex flex-col sm:flex-row items-center justify-center gap-3">
                      <span class="inline-flex items-center justify-center rounded-xl bg-emerald-500 px-6 py-3 text-white font-extrabold shadow-sm hover:brightness-95 transition">
                        Pilih File
                      </span>

                      <button
                        type="button"
                        class="inline-flex items-center justify-center gap-2 rounded-xl border border-slate-200 bg-white px-6 py-3 font-bold text-slate-700 hover:bg-slate-50 transition"
                        onclick="alert('Integrasi kamera (getUserMedia) bisa ditambahkan kalau kamu mau.')"
                      >
                        <i class="fa-solid fa-camera"></i>
                        Gunakan Kamera
                      </button>
                    </div>
                  </label>

                  <!-- Action button (disabled by default like screenshot) -->
                  <button
                    id="detectBtn"
                    type="submit"
                    disabled
                    class="w-full rounded-2xl px-6 py-4 font-extrabold flex items-center justify-center gap-2
                           bg-slate-100 text-slate-400 cursor-not-allowed"
                  >
                    <i class="fa-solid fa-wand-magic-sparkles"></i>
                    MULAI DETEKSI
                  </button>
                </form>

                <!-- RESULT SECTION -->
                {% if prediction %}
                <div class="mt-6 rounded-2xl border border-emerald-200 bg-emerald-50 p-5">
                  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                    <div>
                      <div class="text-xs font-extrabold tracking-widest text-emerald-700">HASIL DETEKSI</div>
                      <div class="mt-2 text-lg font-extrabold text-slate-900">
                        Penyakit: <span class="text-emerald-700">{{ prediction }}</span>
                      </div>
                      <div class="mt-1 text-sm text-slate-700 font-semibold">
                        Confidence: <span class="font-extrabold">{{ confidence }}%</span>
                      </div>
                    </div>
                    <div class="text-sm text-slate-600">
                      <i class="fa-solid fa-circle-info text-emerald-600"></i>
                      Pastikan foto fokus & pencahayaan cukup.
                    </div>
                  </div>

                  <div class="mt-4">
                    <img src="{{ img_path }}" alt="Hasil gambar" class="w-full max-w-md rounded-2xl border border-slate-200 bg-white">
                  </div>
                </div>
                {% endif %}
              </div>
            </div>

            <!-- Footer bar (like screenshot) -->
            <div class="mt-6 border-t border-slate-200 pt-5 text-xs text-slate-500">
              <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                <div class="flex items-center gap-2">
                  <i class="fa-solid fa-circle text-slate-300 text-[10px]"></i>
                  <span>Rice Health System AI</span>
                </div>

                <div class="flex flex-wrap gap-6">
                  <a href="#" class="hover:text-slate-700">Kebijakan Privasi</a>
                  <a href="#" class="hover:text-slate-700">Syarat &amp; Ketentuan</a>
                  <a href="#" class="hover:text-slate-700">Hubungi Kami</a>
                </div>

                <div>© 2024 Rice Health System. Hak Cipta Dilindungi.</div>
              </div>
            </div>
          </section>

          <!-- RIGHT PANEL -->
          <aside class="space-y-6">
            <!-- Preview -->
            <div class="bg-white border border-slate-200 rounded-2xl shadow-sm overflow-hidden">
              <div class="px-6 py-4 border-b border-slate-100">
                <div class="text-[11px] font-extrabold tracking-widest text-slate-500">PRATINJAU GAMBAR</div>
              </div>

              <div class="p-6">
                <div class="rounded-2xl border border-slate-200 bg-slate-50 h-56 flex items-center justify-center overflow-hidden">
                  <div id="emptyPreview" class="text-center text-slate-400">
                    <i class="fa-regular fa-image text-5xl"></i>
                    <div class="mt-3 text-xs">Belum ada gambar yang dipilih.</div>
                  </div>

                  <img
                    id="previewImg"
                    src="{% if img_path %}{{ img_path }}{% else %}{% endif %}"
                    alt="Preview"
                    class="hidden h-full w-full object-cover"
                  />
                </div>
              </div>
            </div>

            <!-- Tips -->
            <div class="bg-white border border-slate-200 rounded-2xl shadow-sm overflow-hidden">
              <div class="px-6 py-4 border-b border-slate-100 flex items-center gap-2">
                <i class="fa-solid fa-lightbulb text-emerald-600"></i>
                <div class="font-extrabold text-sm">Tips Hasil Terbaik</div>
              </div>

              <div class="p-6 space-y-4 text-sm text-slate-700">
                <div class="flex gap-3">
                  <span class="mt-0.5 h-5 w-5 rounded-full bg-emerald-500 text-white flex items-center justify-center text-[11px] font-extrabold">✓</span>
                  <p>Hindari gambar yang buram atau tidak fokus.</p>
                </div>
                <div class="flex gap-3">
                  <span class="mt-0.5 h-5 w-5 rounded-full bg-emerald-500 text-white flex items-center justify-center text-[11px] font-extrabold">✓</span>
                  <p>Ambil foto daun dari sudut atas secara tegak lurus.</p>
                </div>
                <div class="flex gap-3">
                  <span class="mt-0.5 h-5 w-5 rounded-full bg-emerald-500 text-white flex items-center justify-center text-[11px] font-extrabold">✓</span>
                  <p>Gunakan pencahayaan alami yang cukup.</p>
                </div>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </main>
  </div>

  <script>
    // enable button when file chosen + preview image
    function handleFileSelect(event) {
      const file = event.target.files && event.target.files[0];
      if (!file) return;

      // preview
      const previewImg = document.getElementById("previewImg");
      const emptyPreview = document.getElementById("emptyPreview");
      previewImg.src = URL.createObjectURL(file);
      previewImg.classList.remove("hidden");
      emptyPreview.classList.add("hidden");
      previewImg.onload = () => URL.revokeObjectURL(previewImg.src);

      // enable button
      const btn = document.getElementById("detectBtn");
      btn.disabled = false;
      btn.className =
        "w-full rounded-2xl px-6 py-4 font-extrabold flex items-center justify-center gap-2 " +
        "bg-emerald-500 text-white shadow-sm hover:brightness-95 active:scale-[0.99] transition";
    }

    // optional: drag & drop
    const dz = document.getElementById("dropzone");
    const input = document.getElementById("fileInput");

    ["dragenter","dragover"].forEach(evt => {
      dz.addEventListener(evt, (e) => {
        e.preventDefault(); e.stopPropagation();
        dz.classList.add("ring-2","ring-emerald-300","bg-emerald-50");
      });
    });

    ["dragleave","drop"].forEach(evt => {
      dz.addEventListener(evt, (e) => {
        e.preventDefault(); e.stopPropagation();
        dz.classList.remove("ring-2","ring-emerald-300","bg-emerald-50");
      });
    });

    dz.addEventListener("drop", (e) => {
      const files = e.dataTransfer.files;
      if (!files || !files.length) return;
      input.files = files;
      // trigger preview + enable
      handleFileSelect({ target: input });
    });
  </script>
</body>
</html>